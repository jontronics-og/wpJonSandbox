let NY_SURF_SPOTS={canet:{name:"Canet-en-Roussillon",lat:42.6589,lng:3.034},rockaway:{name:"Rockaway Beach",lat:40.5825,lng:-73.8358},longBeach:{name:"Long Beach",lat:40.5885,lng:-73.6579},lido:{name:"Lido Beach",lat:40.5908,lng:-73.6343},gilgo:{name:"Gilgo Beach",lat:40.6179,lng:-73.3846},southampton:{name:"Southampton",lat:40.8679,lng:-72.3893}};async function checkSurfConditions(){var t=document.querySelector("#surfResults"),a=document.querySelector("#checkSurfBtn");try{a.disabled||(a.textContent="Checking...",a.disabled=!0),console.log("API Root URL:",surfAppData.root_url),console.log("Nonce:",surfAppData.nonce?"Present":"Missing");var e=Object.entries(NY_SURF_SPOTS).map(([t,a])=>{var e=`${surfAppData.root_url}surf-app/v1/conditions?lat=${a.lat}&lng=`+a.lng;return console.log(`Fetching data for ${a.name}:`,e),fetch(e,{headers:{"X-WP-Nonce":surfAppData.nonce}}).then(e=>{if(e.ok)return e.json();throw new Error("HTTP error! status: "+e.status)}).then(e=>({beachKey:t,beachName:a.name,conditions:e})).catch(e=>{throw console.error(`Error fetching ${a.name}:`,e),e})});displayResults(await Promise.all(e))}catch(e){console.error("Detailed error:",e),t.innerHTML=`<div class="error">Error: ${e.message}</div>`,"API Call Limit Reached"!==a.textContent&&(a.textContent="Check Surf Conditions",a.disabled=!1)}}function calculateSurfRating(e){let t=0;var a=e.waveHeight.noaa,n=e.windSpeed.noaa,e=e.wavePeriod.noaa,a=(a<.5?t-=3:.5<=a&&a<1?--t:1.5<=a&&a<=3?t+=3:1<=a&&a<1.5?t+=2:3<a&&a<=4&&(t+=1),10<=e?t+=3:8<=e?t+=2:6<=e&&(t+=1),n<10?t+=4:n<15?t+=2:n<20&&(t+=1),Math.round(t/10*5));return Math.max(1,a)}function getWindDirection(e){return["N","NE","E","SE","S","SW","W","NW"][Math.round(e/45)%8]}function convertToFahrenheit(e){return null==e?null:9*e/5+32}function getRatingInfo(e){switch(e){case 5:return{label:"Epic",color:"#2ecc71"};case 4:return{label:"Great",color:"#3498db"};case 3:return{label:"Fair",color:"#f1c40f"};case 2:return{label:"Poor",color:"#e67e22"};default:return{label:"Flat",color:"#e74c3c"}}}function getWaveHeightNote(e){return e<1?"Too small":1.5<=e&&e<=3?"Ideal":3<e?"Large waves":"Fair"}function getWavePeriodNote(e){return 10<=e?"Excellent":8<=e?"Good":6<=e?"Fair":"Choppy"}function getWindNote(e){return e<10?"Good conditions":e<15?"Fair conditions":"Strong winds"}function displayResults(e){var t=document.querySelector("#surfResults");let l='<div class="cards-grid">';e.forEach(({beachName:e,conditions:t})=>{var t=t.hours[0],a=calculateSurfRating(t),n=getRatingInfo(a),o=getWaveHeightNote(t.waveHeight.noaa),i=getWavePeriodNote(t.wavePeriod.noaa),c=getWindNote(t.windSpeed.noaa);l+=`
            <div class="card">
                <div class="tag-rating">
                    ${a}/5 <span class="rating-label" style="color: ${n.color}">${n.label}</span>
                </div>
                
                <h3 class="card-title">${e}</h3>
                
                <div class="card-content">
                    <div class="condition-item">
                        <span class="condition-label">Wave Height</span>
                        <span class="condition-value">${t.waveHeight.noaa?.toFixed(1)||"N/A"}/ft</span>
                        <span class="condition-note">${o}</span>
                    </div>
                    
                    <div class="condition-item">
                        <span class="condition-label">Wave Period</span>
                        <span class="condition-value">${t.wavePeriod.noaa?.toFixed(1)||"N/A"}/s</span>
                        <span class="condition-note">${i}</span>
                    </div>
                    
                    <div class="condition-item">
                        <span class="condition-label">Wind</span>
                        <span class="condition-value">${t.windSpeed.noaa?.toFixed(1)||"N/A"}/mph ${getWindDirection(t.windDirection.noaa)}</span>
                        <span class="condition-note">${c}</span>
                    </div>
                    
                    <div class="condition-item">
                        <span class="condition-label">Water Temp</span>
                        <span class="condition-value">${convertToFahrenheit(t.waterTemperature?.noaa)?.toFixed(1)||"N/A"}Â°F</span>
                    </div>
                </div>
            </div>
        `}),l+="</div>",t.innerHTML=l}document.addEventListener("DOMContentLoaded",async function(){let t=document.querySelector("#checkSurfBtn"),a=document.querySelector("#lastCheckedBtn");var e=localStorage.getItem("lastApiCallDate"),n=localStorage.getItem("lastCallTime");let o=(new Date).toDateString();e===o&&(t.textContent="API Call Limit Reached",t.disabled=!0,a.textContent="Last checked: "+n,await checkSurfConditions()),t.addEventListener("click",async function(){try{t.textContent="Checking...",t.disabled=!0,await checkSurfConditions(),localStorage.setItem("lastApiCallDate",o);var e=(new Date).toLocaleTimeString();localStorage.setItem("lastCallTime",e),t.textContent="API Call Limit Reached",a.textContent="Last checked: "+e}catch(e){console.error("Error:",e),t.textContent="Check Surf Conditions",t.disabled=!1}})});